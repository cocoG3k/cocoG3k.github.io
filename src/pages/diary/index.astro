---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const diaryEntries = (await getCollection("diary")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);

const formatDate = (date: Date) => date.toISOString().split("T")[0].replace(/-/g, ".");
---

<BaseLayout title="cocoG | 日記一覧">
  <main>
    <header>
      <div class="brand">Coco G3k</div>
      <nav>
        <a href="/">ホーム</a>
      </nav>
    </header>

    <section class="hero" style="padding-bottom: 32px;">
      <div>
        <span class="badge">Diary archive</span>
        <h1>日々の記録</h1>
        <p>小さな気配や、光の色を集めた日記の一覧です。</p>
      </div>
      <div class="card">
        <h3>最新のひとこと</h3>
        <p>ページをめくるように、静かな記録を辿ってください。</p>
      </div>
    </section>

    <section class="diary-list">
      {diaryEntries.map((entry) => (
        <a class="diary-entry" href={`/diary/${entry.slug}`}>
          <span class="entry-date">{formatDate(entry.data.date)}</span>
          <h3>{entry.data.title}</h3>
          <p>{entry.data.description}</p>
        </a>
      ))}
    </section>

    <footer>
      <span>© 2024 Coco G3k. Written with calm.</span>
      <span>Tokyo / Home desk</span>
    </footer>
  </main>
</BaseLayout>
